# Document Worker

![](https://lh3.googleusercontent.com/fife/AMPSemeB57pvmyH2pfPLj08wvCNAL6oXHZH0VoWlog5A4sTzAvCQ-PRtf6yOoHSmyXnmv64UaS7zyl2QhEVtYFyer3tP_UYuAxEPiip9otf5gRXJB0QDLQIqGbgb2bvkwirf5TM3ciUr2Jx8qnZOnXnp22QIAqCHFcSfQo0BoqWNCg3SKd2nWFpQhIpuY003B-ym_ApzvybNHUu566DM9bOqc-ZiFKoHU5yu-VSg4gQvJy7cuLQHlriyx7wZA82n27-F91TvhIcjVNrzab-3WCMBz-W8WtiJgO2i1-7j39luLlQl1oDZSKD8nh6F7tI935w4lb2JEKq24Hh3gqK5egKme96qA3RlCtIuzqJPGSVEQVfhDvURdrmMZdqfbWeWD2hfacuKp8j6fTUmfB1QpyGASAaItsSxjO1-0T6x2urzI6EGn-7ZFWB6AH9Cxm_DeuFi13ElQkBNOp5dQNTNvdv8Ld_QkFf9_2cvymsT7dXA9UJSjVrJlTNvacjjxBl4ErSLXKfEqddEbVE3AUgn0a-CKIqGgM1gmJTcl-os3JyfNEXGGmbE2u7irFYKUDP1HqPgA2kZ0yK9hwXF5fu-T1nBJhqz56Kfk8h8K5l8RRAkhsZjgOq97FM_EQ5WC8Cqp7pU48U_r4wKWXaNItxK0f5px6L7lA3NxOG-_6taWnrP2quTCkyH9oLmHi8shQqu1-hOxPSbTXc4PWvwXedsBXBg4Kks8Skv4qol9MA0fGXir1Q45FtCanrFtx7EfgGnSEaC47whx1_ieBoCCjppFgYusHYwII0ldBvNFlGiOsiN-eISIImT1sn_CsaJ5iY1D1p5XNz_UcYps84VKQK7aeW5ouX8K34HA-8YPbFVIuCcanbhzDjXRausNN018tQI4TwTRUxBUAfh2cO_B1-c9W5mGtwL229xju_NOLSnYssAgHVnUxHFvmf-agTeGx0negS5uV-cXV33UnyJhz46dZrGzrkMu6cqQGRJPtVnawsKeecz-TM4N0MJLj90NuSar_Zb3gAMwkZ5kXzowAxbm43WVJsoRxtLhVmst-NI63rpuTDuLN1ILtC9zVugeIfqypqpRx8tZ1HFb7t8W2jD7PCsxcsa1WtMJBH6IL0NviEALw_KRWGnMYUmV2NI7cblF0p8zqVgpzOw43cdGe-C2_WIhIitbzE_rBSB1iklCQQrJNhj7qbx1lvdzvDqWZG67YMixydTgXsxtEVktHc9Cs6WVPizdRFhZnUmAQW3sDjse028lBI3chOv4fZFlmXaK4oIXBUG2Q0bja_p-5UKi-MqpueytUFZbE9UWn5b6SkZFbft4oYaMy3r2GerGcU_OTeHInnJIW_MbUWhoXf1n7FruB1HSTGKksrBEmC3FsvhyzwUPHdLSAyqJvquPSZFv_qp2pHlAN1yOZySxaFhx8WInnU-U3b2SUzle6ewRhXQkb1EVPr6KUyGy7Iq0u1XdP_ACkeUp40hoev9CMyUgfFTYA=w1920-h940)

Document Worker - это Windows Desktop приложение построенное на WPF технологии. Его цель - автоматизация рутинной работы с большим количеством xlsx файлов (заказов интернет-магазина), а так же оформление прайс-листа с 4,5 млн ячеек. Настройки программы под каждый город сохраняются в xml файл и могут изменяться и дополняться.

В качестве графической оболочки был выбран WPF UI от [lepo.co](https://wpfui.lepo.co/). UI из коробки позволяет менять тему оформления приложения, а так же добавляет в проект кастомную навигацию и службу зависимостей (DI).

В проекте были использованы такие библиотеки, как:
- ClosedXML
- CommunityToolkit.Mvvm
- EPPlus
- Microsoft.Extensions.Hosting
- Microsoft.Xaml.Behaviours.Wpf
- WPF-UI

Организация, для которой было написано это приложение, представляет собой франшизный интернет-магазин. По их внутренним правилам, франшизные точки имеют свое юр. лицо, свой вариант оформления бланка заказа, оформление прайс-листа и соответственно номера телефонов. Соответственно, оформление всех этих данных и выполняет программа Document Worker.

В xml файле "из коробки" есть информация о 4-х городах. Она включает в себя - название города, юр.лицо, название организации, телефоны отдела продаж и службы доставки, а так же имя представителя продавца. Пользователям дается возможность добавлять в файл новые города, удалять, а так же редактировать данные любого города.

![](https://lh3.googleusercontent.com/fife/AMPSemd9oVIuVqYP-13iBYpp2PIr2QQiS3k47TpNk0zFjywbM3Iq_SjzaSgqAu2nhJ2BZ7dcOhgQp-x36k1rQeDTWIFcT12S1pPHQ6gCBbteieczFWavx2JTCG4Vi8a1x80n7vo53QK7YwRvC4WpWiLxAm-0T7sbO7PuD28C06_0KxdKkijgYDRAHpTucIEN9fqc84kikEP04HVyHRipcqq4Q6zUSaX7B278hag7sEJN1hbnLtXsIB85SbJQKE-Z1B3D76q7YlVzgnfWMK-Z97dAug-NMKCd_A9COCLPV3No8LSQN3JjcIIy3gYTjjY1IcU9zB49eUrWZPiD1k2KDb9YK9hWYo9J71xQZibU0qC0h3FIBBV9vmo7JX0SMs2dCURtzHP80kEEFBdMEZObeZri-v5QhTXEk1KMq-ETLkW7087O-hkfqyzGaF-JVQDDpYluzJ0opKdx3hN3j6EnbFTmCI34thSQpTXegPcgqYyOsySHjLUb8S6WVNckWLhKLvawl_05ksGDz10bB9qdbmNFOyW2ewllznw0R1QN1KFjc1qq1GYBoq7qyQp1Yja6biDAnd9ixQtTnmZVk6aj6U6_PSsj5H_lOFhFxEC9if6luY4qV8YmykVaX45G_mGQpyxmZsSJWjYiqd0KcTLbGlxPs2pTpKK7qqf5g9h-erzvUUF2KwP2uvqlo_GNNf6X7N4BP81oFYAVMVqfMEb9-mt7IIKbll7kCfomtQtaLicCLeGUVbemsJLntfKoysiEXDtRYPfEdxRme_gXSAzdi0Pbr4jQtVkdY4nvHHVooOVlNkAVzAio6hzP5V-a9A4u5u4duPjczwk2vrOKrE71rlbE1ipjQNrj9Lozc4GGoZE6gdCov0L92cBKXdlBf7-K9QQ173OJ-Rr33MRu1QXJcp-jKDodDYmZjeD1mCp0UMijBebGEtkxyRQfSPgz7tWMRuH6qknZkXSD5KuRGztpYHFt6VdeG70ZaSxCoq7J4Ugeb3pRrNSpc83HbDqu8XIpPm_lKPc4veiiu4pjRW3OBMoOvwO1yXO1Gm8ivvbUr0Y8Sx6b_XP0VgfNmktHSuH4uP1YRGJ-XURwfBAsl6hgKD03Q9hJRCJoThcRH_nFIzOmF6B9nNdFfVD1SHw3IGEftV5Sh6pJw07IYOsByen1pCD6sltjz9RUNSCZnH46U1AEjTvG9kyyuMVdozfcJ4fsH03vGtS9vwdhFerc-YFBiyKHHDHioSXqI4r4WOqZfE4lhh2BZruZUprgc7ukyqrygNf8CQaO11fQo9K8WzQb3Ya3J90JIZHahsFFplABemq9_aQdBiayVJKxf1igeSrmktC-II0BFzJgP9dcf7l3XjJFQ6CQVkZ5X1lA0ZlfQEGBbCCy53_d2r91qEJ1093pkG97xj2qlPBeQGbMDyvqVpSSj5Nrmaro_hfQTtYQRcjbcx9fXbBbOdAe7Xe_tkmHBqQ-9qS2Fqei9fuBwMwMZQJNuQ=w1920-h940)

На ключевых полях в форме проводится проверка введенных данных. Если их не заполнить, то валидация не позволит внести изменения, добавить новый город или начать работу с файлами.

![](https://lh3.googleusercontent.com/fife/AMPSemeaMmNmA-Jjtxjm3mm4_pfaaZB6dI57fwj5s4KCQOxTj8yhiikzIu9MTiwvM_eu9_JfAZvv3EEd5d3UbcU-baCkokxDELMJDeCMhdlI_kv7Jofyaao1dwDdS1BmJI73sWH9g3zUQllWJ6z71I6im7kSFHLLPPbzlv38J6Nmhvq2SPVJO8NU61S_WEkPJ7330Frnh7Ik0-jtOOsuxDScwHdVMlCzlT-vJLn_JnBfebYa78agMyRZgWSyL7JyFVH3fNt_Tu-qTmcekGmoNfUO0S2v18rwzk0nd3qWUccPuK9WUI0Yp8BBu_iJIP0W7uZ0h6VCb0Xfovm9LS1SZJ4AFtuu7OkAzOc7XyfqXp7wnA_q2eMZE_c9zJe4J6JrbTTCxfxArhWWjanZHI3GfIqq86HjlCvWFD7Uf2b_K6nPghgSua5IaBsLDwVc7Y2li2so-OCUDDbfmax_bX5lVkvN2a6Kdw1ZrBhYljrPiye1SQqQLlp1Q7uXVHh5-frBtenw2ZN73ueRpfSVHOLD97X8zvPtJKk0VaqdXf--sjS4Rx9VAN52Jz0C3KtF28dbc3XqqCpQoW7BT8FuAGR3ZNC5OZraWjSi-JoKQlzM-FcASZ974AZypnNApiur3pq11d2uX55FPD5icCezL0U_CcqHh6-IeKM2JXvd6KRv0S8M29RwJkkRX6BtcYWrNmGIgyNMFNw15Au1N-_5KXtQMmw-mY7haFTpz-EyNnL2WkfZ84WHjce00JcJDxgWRsc8DhrmYq-oaJiAHlGctc4Xxk1XkeAUXGfGOGwHRG0E9SkxdoaXWmqHhajeaeEIYECL5bUwIuk8sNQhCtZdkbaljwnRbXoabzP_rji_fCapQ3IfDOmo6VRgcIlm_gGxKm8pzT2Vjgvn2iVIQuDL54pdioZn9y60ePAGMYsOnj-So0hIcfuDC5Rb32aX1eTUbu5-1GBOG_GzskVzLNYAympes7GZE8O0yTbakJkrBwJJ-UDh121Kk8EaXgXFVb9KQUByH91Itfs8pbE5NdPe4Mh4IjF5kfF065kPTv1SsRnAHt6MgzKvKQ1GG6ANL316drDZm1gwmYye-nZ_DK4VG_1S63OcR_mqPCFQ28GSshaqiSnAYgZ-yh8kwpjUr0SWx4UHStEoVeVyMtGbyYsCha9L91ZqClghtGlK9AcnKSgJaW2Uc492jw-v4NdMRLx-iRQeHrfaSpN1L1UqIQ3Ql6kx1gLR_4Rie8Rd6Kx0o7GDBvYxBv11WlR0G_VGyIL6YuG5FA-ZItF15DGX9g-XB6QixuZ07gEdsamYUY--qXmhhITYzS1fZknBGNAKwYtHBR9onfpVoBqtWxbOuFQz9effHujS6M_PVwYUWeAQfzXuJ1m6aucxi97sxjNll-NreRmnaoQhAZSKv0TD9kPfO4dSulo8wSnOU3OfE_BDPbJYMdgtiN7uzd6jDQ_oY0W76Clti1D2ODpbM399nczY-WitBbEiZA=w1920-h940)

Реализуется это с помощью CommunityToolkit.Mvvm, а именно благодаря `ObservableValidator`. Пример поля с названием города:

````c#
/// <summary> Название города </summary>
[ObservableProperty]
[NotifyDataErrorInfo]
[Required]
[MinLength(1)]
private string? _cityName;
````
`ObservableValidator` под капотом реализует интерфейс `INotifyPropertyChanged`
`[RelayCommand]` это один из механизмов Community Toolkit. Он позволяет реализовать привязку в удобном виде, а `[NotifyDataErrorInfo]` позволяет работать с ошибками валидации.

Выполнение методов набора заказов и прайс-листа выполняются асинхронно, что позволяет не блокировать UI и выполнять другие операции.

![](https://lh3.googleusercontent.com/fife/AMPSemftOllBfL2xP5J_MkW2F18TBkKa28Fr-csZfEWhpEzIklR-C6XCE238YfdrnyfxrstOC_1VWz4u78oebIdmd20Mnxe6Lhej-IQGFXJgHDUzypZQsiKd3z0XizB7sa7Ub9poojOe6NUG0ib7XaQ2TtqPb2EEjdozvfky3nrUde1-eyxQRxWUlqYb7V-x21SpdGzn2sOTpPKZw7hv546RrxvJ0h_Q5hXJy3GzkYLAG0BkmWggLNw6f4f8FTW42Y7l0Y_rR0cOe4Sm5qzCYiSJgo0iWdbBqx4hvU6y-SJe4uNZO6bBkNNiNVbj90YHbA-b4moejjb_1dUTZt8dsr9vnMj_mcW1ASmdGmNbqo-1gQio5YQt96Ju1RAbbV4qwnC-RmCsvqTXzmupN3nRhEJii2JrIjXUH829aILL_V0kUC-4MiJ3es5AlYYPUbEeckhrzVaoFfnaiHESMgnE6TCVPB6qHkHdqQ8awvigCsLN9srexylK1JbtUrpGuzNuiwimdkUe9IDaPfaoSZViAGq3v-KpJDcLQdSU3Jme27BiQKfYwvliTdmqwgi_t04YuYfb87_Iae3M4M_U4ygnwZVMpEGbM9_aPB4lX-JgpbbV7EXSBtvTWf8uvw24pU4C_DUZ6AkMpWN66gAJoAfQQmTbrRNkVW5APRUMeELKC5hYtp1OmFHcjpZ1Spe1qyrrazfK3sB9YH_TgDCyyHNTLkL1lJiSTZXgqKQX0WzoD4Djc83mVqKXOu7Ild3tm5Un95TxYqxwfVbjvr1mMJWO9UBStNLXqHE4mZY4loP4tZQl56SLbRz13ftwiHLRJB4DkVeb9b3Nyd66lA668vHXroEYcSAvx0YXx5Y-dmhmluQJ1yfyHHBWH1x9vP_JnmPd0QJG0nYDJ-y1vis_rkavfCpqAIt1dgHvPCW4MkfZSeJVe-V5IJhr5yw-vY3yYO4G1NVjEdV2Dvp5U13RNMGpNQ9VnCL5m8iZXxfsvZs1wr4-pSmyFIQEmLzOhZxS5AIjsKcFB28jeqp5BByAxzhh31EY-Aaa4SuwtU1GojYv6RKIB3jVi1GzaxGXPf6eIME7aGFKWb07nh3Txqd6_8yPHb8rO4jJnfGMiaB6WYAuvMGRsQWAKN63HNZD6hN9h8bORp9ngE33PnHz1QNkUMuNmjrN4HIp28-GCL328AcTe-kNQu4DHarPxtoQLWC7Kv7niaciG4dG8LN4JLRgmUOw2hoyOnN85q5zbZhFxA2yb2vluzxA_9d3mqxkyhHtyH0dZEtAX-gKs8xYmOw5HarmnnUtXV0kwJj8louVfaYoDiy6R4S7Qmhh8owSQFCZAE8YE3NnIeUY5kbxf0pGBRLzhokHDJb0mjqrO8aXHzNxPDrcseI_L4mybOTY25fcwdwzQSq_LbWVTu0i1ylgNdtDjlIpHMlM0YUiAgFwXq0FyIZnv4-54891r6a2Ze7F69wINYg5UUjI3YsDxbFUNwfOHEw1PA=w1920-h940)

Операция набора прайс-листа достаточно трудоемкая и потребляет достаточно много оперативной памяти. Файл с прайсом весит около 25 мб и суммарно имеет не менее 4.500.000 ячеек с данными. Из-за этого при совместном выполнении сразу двух операций, набор заказов происходит медленнее. Это хорошо видно в сравнении.

![](https://lh3.googleusercontent.com/fife/AMPSemcq9tnALtuPjNaG28G1EXu6wAI5-9xm2kiSYSURxLD0umDiH4OfNIy0YrtdAIZPiFeZ8jx4URpnlE9z0FBsCD4exjJaqesmavsotBqKUUVrkStwvmw_7S-5kkZJT8IRF7fzArJuAC_ITI9E4tkcBWPg8kH64SN_GAQbVnhlS82vIaTWy7huiajSlAZKibKHZYvXB4GMvNPdTSL-c6jwvaAseZF4Fc632kRkb0DizUJIGBUE0iMO6VDLUjDROwxKG0XBs3IecKOpMlfZ1eUHNpvlxP62_OSi3iw5xA6xOvCTPG9sUbU973DIclo6wEmYzIGzcKi2Jjzv2vjQ5JHG7QyLPGOytLBe7jBYnziy_cSg7_UwE9HAXbrgbhIZIxFD-cUuZ9QGJehXtYdBt74YnbTqcuPwM3o2u4Ow3aj0PD0UIZlBZtupOlsrOi3zpyWCZOYPBe24SbzQhl2BvivOsYT6oDmUorvyOiCVUHz0ZbKQ5SeTpf4mYFh7TiGDyHmjIBWAoU2ly5vhiskPM89h9jVFCTjKcEC5ozv5sI3_DLDLKMzGcWN2L6QbkQc8jvRz1EAcY3-Hw-KOpZp9aUL9zBoPv8V8HaLGnWNNrgIxmcvj9AsFTd3i3igy2Dx3IJavsinWN806plWiBjaZF3C0KM4krR4Xdhzp924C62ybl0bdQgzPrxPkT7qyqKtGZ66eJa9cZkSUi-1kqzZ8G33JgHbHlX9QMV0bvQjIrwsCh7LqkJUOeLZ5hC6YYSS3jceh1H1pqy756KFqKg-e88Wv_0jGeo_zTOtFZ4RGunXVDVOA4we0TNRixPbz_cMByRhStU4fzvSXuNqa5r0W5dRakPtEGhvduB30DDvjYMWl8J7gjC4T-_YgOaJIDWXnj99azbH0xxhb_hvP43uZ6a1ZFCsqN714eo0U_5SdHFZbEetJbthvnRu3KmocKX6hj5EgMz6j966jF-bnwHBIBOwMWZGazn5lfAlXGa8MUoZa-Qbir59vAVPxxpbSAeZr7JI7IYp3B6BuUSlrYuHSu5K0z1ZJPz1sx5fHkxiUrRidXG-HsBgrnyQGCYesLBrAgxdqzomZFAvpX_UJJy_aiHkz_9NxZmVZ-u8-3aFtjSRfhUK96J7cxRn4UjEPlrgJpht1mZI7EzPK3SrMHMVF48z59yw9ath8L4zD6npAajXoNokdGdrFeOpaYCdgK_EIvHl8OW41D2SdaHOcBEp92DYIiZ56tPd3cwy-6NkswMh02REn3jFGLa0QbLsM01jgseFdF6o5yyhD27hHM23alQWNx4-Btd2lewxt306B3sWOOZ5_oZgLxbnV-K3Hb-nd3elTa7G8CnEm2Z08cSjZQCYQzL6cID0IJ8QF5PBXjqDWAdFZMQluTiR9D5xc6v0laWmVr-l61zoU_lny_X7CdUHjDQLOUbuugFb54_rbClnRLtCyPNHXp75xV4key4p5ZOYqI1yKGf3t3HCk0G_lG9iG_w=w1920-h940)
